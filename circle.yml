machine:
  python:
    version: 2.7.11
  services:
    - docker

dependencies:
  cache_directories:
    - ~/.pyenv
    - ~/docker
  override:
    - docker info

    - curl -fsSL https://git.io/v2Ifs -o ~/bin/circleci-matrix
    - chmod +x ~/bin/circleci-matrix

    - pip install -U scikit-ci-addons

    - cd $HOME && git clone git://github.com/python-cmake-buildsystem/python-cmake-buildsystem --branch dashboard --depth 1 scripts

    - circleci-matrix:
        parallel: true
        environment:
            STEP: dependencies

test:
  override:
    - circleci-matrix:
        parallel: true
        environment:
            STEP: test
